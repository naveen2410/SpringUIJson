<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <title>Spring Boot ajax example</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>

    <link rel="stylesheet" type="text/css"
          href="webjars/bootstrap/3.3.7/css/bootstrap.min.css"/>
          
          <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
          
     <!--      <script type="text/javascript"
        src="webjars/jquery/2.2.4/jquery.min.js"></script>

<script type="text/javascript" src="/connplantsTest/src/main/resources/static/js/main.js"></script> -->
          
          <script type="text/javascript">
		
			function selectOrder(user){
				
		      
				alert("I m about to call ajax... Hold tight and put your seat belts on!!");
				//alert("Hello " + user.username.innerHTML);
			    //document.getElementById("feedback").innerHTML = "<h4>Ajax Response</h4>";
				
				var str = $("#username").val();
		        alert("username 3 = "+str);
		        
		        
		        var search = {}
		        search["username"] = str;
		        
		        $.ajax({
		            type: "POST",
		            contentType: "application/json",
		            url: "/api/search",
		            data: JSON.stringify(search),
		            dataType: 'json',
		            cache: false,
		            timeout: 600000,
		            success: function (data) {

		                var json = JSON.stringify(data, null, 4);
		                $('#feedback').html(json);

		                console.log("SUCCESS : ", data);

		                $("#scheduleTable").find("tr:not(:first)").remove();
                        var trHTML = '';
var obj = json;
                        for (var i = 0; i < obj.length; i++) {
                            trHTML += '<tr><td><label>' + obj[i].username + '</label></td><td>' + obj[i].password + '</td></tr>';
                        }
                        $("#scheduleTable tbody").append(trHTML);
		                

		            },
		            error: function (e) {

		                var json = "<h4>Ajax Response</h4>&lt;pre&gt;"
		                    + e.responseText + "&lt;/pre&gt;";
		                $('#feedback').html(json);

		                console.log("ERROR : ", e);
		                $("#btn-search").prop("disabled", false);

		            }
		        });
		        
				
			}
		</script>
          
</head>
<body>



<div  >

    <div >
        <h1>Spring Boot AJAX Example</h1>

        <div id="feedback"></div>




        
            <div >
                <label >Username</label>
                <div >
                    <input type="text"  id="username"/>
                </div>
            </div>

            <div >
                <div>
                    <button  id="bth-search" onclick="selectOrder(this);"">Search
                    </button>
                </div>
            </div>
  

    </div>
    
    
    <div  style="width:100%">
		
<table id="scheduleTable" align="left" class="order-table" style="width: 50%">
        <thead>
        <tr>
            <th align="left">Subject</th>
            <th align="left">Date</th>
        </tr>
        </thead>
        <tbody></tbody>
    </table>

	</div>

</div>




</body>
</html>